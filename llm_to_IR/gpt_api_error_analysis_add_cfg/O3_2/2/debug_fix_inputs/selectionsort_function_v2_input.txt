; === ERROR LOG BEGIN [llvm-as] ===
; llvm-as-14: ../../llm_to_IR/gpt_api_error_analysis_add_cfg/O3_2/2/selectionsort_function1.ll:50:18: error: expected instruction opcode
;   %minPtr_1250 = %minPtr
;                  ^
; === ERROR LOG END ===

; ModuleID = 'selection_sort_module'
target triple = "x86_64-unknown-linux-gnu"

define void @selection_sort(i32* nocapture %arr, i32 %n) {
L1210:
  ; endbr64 (no-op in IR)
  %cmp_n_le_1 = icmp sle i32 %n, 1
  br i1 %cmp_n_le_1, label %L12A8, label %L1230

L1230:                                               ; preds = %L1210, %L127B, %L1290
  %idx = phi i32 [ 0, %L1210 ], [ %i_cur_phi, %L127B ], [ %i_cur_phi_1290, %L1290 ]
  %p = phi i32* [ %arr, %L1210 ], [ %p_next, %L127B ], [ %p_next_1290, %L1290 ]
  %n_minus1 = add nsw i32 %n, -1

  ; r9d = r10d (min index = idx); r10d = idx + 1
  %i_cur = add nsw i32 %idx, 1

  ; load original value at current position
  %orig = load i32, i32* %p, align 4

  ; if (n <= i_cur) goto L1290 else proceed to inner loop
  %cmp_n_le_i = icmp sle i32 %n, %i_cur
  br i1 %cmp_n_le_i, label %L1290, label %L1262_pre

L1262_pre:                                           ; fall-in to inner loop setup
  ; r12 = p + 1
  %scan0 = getelementptr inbounds i32, i32* %p, i64 1
  ; initialize inner loop state
  br label %L1262

L1262:                                               ; preds = %L1262_pre, %L1250, %L126B
  ; PHIs for inner loop
  %j = phi i32 [ %i_cur, %L1262_pre ], [ %j_next_1250, %L1250 ], [ %j_next_126B, %L126B ]
  %scanPtr = phi i32* [ %scan0, %L1262_pre ], [ %scan_next_1250, %L1250 ], [ %scan_next_126B, %L126B ]
  %minVal = phi i32 [ %orig, %L1262_pre ], [ %minVal_1250, %L1250 ], [ %minVal_126B, %L126B ]
  %minPtr = phi i32* [ %p, %L1262_pre ], [ %minPtr_1250, %L1250 ], [ %minPtr_126B, %L126B ]
  %i_cur_phi = phi i32 [ %i_cur, %L1262_pre ], [ %i_cur_phi, %L1250 ], [ %i_cur_phi, %L126B ]
  %p_phi = phi i32* [ %p, %L1262_pre ], [ %p_phi, %L1250 ], [ %p_phi, %L126B ]
  %orig_phi = phi i32 [ %orig, %L1262_pre ], [ %orig_phi, %L1250 ], [ %orig_phi, %L126B ]

  ; ecx = *scanPtr
  %currVal = load i32, i32* %scanPtr, align 4
  ; cmp ecx, minVal ; jge -> L1250 else -> update min
  %cmp_ge = icmp sge i32 %currVal, %minVal
  br i1 %cmp_ge, label %L1250, label %L126B

L1250:                                               ; preds = %L1262
  ; ecx >= minVal path: keep current minPtr/minVal
  ; rcx := r9d not needed; r8 := base + minIdx*4 equivalent to keeping minPtr
  %minPtr_1250 = %minPtr
  %minVal_1250 = %minVal
  ; edx = j + 1 ; rax = scanPtr + 4
  %j_next_1250 = add nsw i32 %j, 1
  %scan_next_1250 = getelementptr inbounds i32, i32* %scanPtr, i64 1
  ; cmp n, edx ; jz L127B else L1262
  %cmp_eq_end_1250 = icmp eq i32 %n, %j_next_1250
  br i1 %cmp_eq_end_1250, label %L127B, label %L1262

L126B:                                               ; preds = %L1262
  ; ecx < minVal path: update min to current element
  %minVal_126B = %currVal
  %minPtr_126B = %scanPtr
  ; edx = j + 1 ; rax = scanPtr + 4
  %j_next_126B = add nsw i32 %j, 1
  %scan_next_126B = getelementptr inbounds i32, i32* %scanPtr, i64 1
  ; cmp n, edx ; jnz L1262 else L127B
  %cmp_ne_end_126B = icmp ne i32 %n, %j_next_126B
  br i1 %cmp_ne_end_126B, label %L1262, label %L127B

L127B:                                               ; preds = %L1250, %L126B
  ; swap: [p] = minVal; [minPtr] = orig
  store i32 %minVal, i32* %p_phi, align 4
  store i32 %orig_phi, i32* %minPtr, align 4
  ; advance p
  %p_next = getelementptr inbounds i32, i32* %p_phi, i64 1
  ; loop condition: r10d (i_cur) vs r13d (n-1); jnz L1230 else epilogue
  %cmp_i_ne_last = icmp ne i32 %i_cur_phi, %n_minus1
  br i1 %cmp_i_ne_last, label %L1230, label %L1288

L1290:                                               ; preds = %L1230
  ; Degenerate path when (n <= i_cur): no inner scan, effectively advance
  ; [p] = orig (no-op)
  store i32 %orig, i32* %p, align 4
  ; r12 = p + 1
  %p_next_1290 = getelementptr inbounds i32, i32* %p, i64 1
  ; loop condition with i_cur
  %i_cur_phi_1290 = %i_cur
  %cmp_i_ne_last_1290 = icmp ne i32 %i_cur_phi_1290, %n_minus1
  br i1 %cmp_i_ne_last_1290, label %L1230, label %L1288

L1288:                                               ; preds = %L127B, %L1290
  ret void

L12A8:                                               ; preds = %L1210
  ret void
}